=======
downloaded 94 KB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/httr_1.4.4.tar.gz'
Content type 'application/x-gzip' length 498400 bytes (486 KB)
==================================================
downloaded 486 KB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/jsonlite_1.8.3.tar.gz'
Content type 'application/x-gzip' length 1165185 bytes (1.1 MB)
==================================================
downloaded 1.1 MB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/lubridate_1.9.0.tar.gz'
Content type 'application/x-gzip' length 960179 bytes (937 KB)
==================================================
downloaded 937 KB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/modelr_0.1.10.tar.gz'
Content type 'application/x-gzip' length 199170 bytes (194 KB)
==================================================
downloaded 194 KB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/purrr_0.3.5.tar.gz'
Content type 'application/x-gzip' length 433144 bytes (422 KB)
==================================================
downloaded 422 KB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/readr_2.1.3.tar.gz'
Content type 'application/x-gzip' length 3575673 bytes (3.4 MB)
==================================================
downloaded 3.4 MB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/readxl_1.4.1.tar.gz'
Content type 'application/x-gzip' length 2334470 bytes (2.2 MB)
==================================================
downloaded 2.2 MB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/reprex_2.0.2.tar.gz'
Content type 'application/x-gzip' length 495129 bytes (483 KB)
==================================================
downloaded 483 KB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/rstudioapi_0.14.tar.gz'
Content type 'application/x-gzip' length 290679 bytes (283 KB)
==================================================
downloaded 283 KB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/rvest_1.0.3.tar.gz'
Content type 'application/x-gzip' length 208459 bytes (203 KB)
==================================================
downloaded 203 KB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/stringr_1.4.1.tar.gz'
Content type 'application/x-gzip' length 206809 bytes (201 KB)
==================================================
downloaded 201 KB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/tidyr_1.2.1.tar.gz'
Content type 'application/x-gzip' length 1148625 bytes (1.1 MB)
==================================================
downloaded 1.1 MB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/xml2_1.3.3.tar.gz'
Content type 'application/x-gzip' length 614541 bytes (600 KB)
==================================================
downloaded 600 KB

trying URL 'http://rspm/default/__linux__/focal/latest/src/contrib/tidyverse_1.3.2.tar.gz'
Content type 'application/x-gzip' length 424097 bytes (414 KB)
==================================================
downloaded 414 KB

* installing *binary* package ‘sys’ ...
* DONE (sys)
* installing *binary* package ‘bit’ ...
* DONE (bit)
* installing *binary* package ‘ps’ ...
* DONE (ps)
* installing *binary* package ‘digest’ ...
* DONE (digest)
* installing *binary* package ‘base64enc’ ...
* DONE (base64enc)
* installing *binary* package ‘fastmap’ ...
* DONE (fastmap)
* installing *binary* package ‘rappdirs’ ...
* DONE (rappdirs)
* installing *binary* package ‘rematch’ ...
* DONE (rematch)
* installing *binary* package ‘prettyunits’ ...
* DONE (prettyunits)
* installing *binary* package ‘evaluate’ ...
* DONE (evaluate)
* installing *binary* package ‘yaml’ ...
* DONE (yaml)
* installing *binary* package ‘xfun’ ...
* DONE (xfun)
* installing *binary* package ‘backports’ ...
* DONE (backports)
* installing *binary* package ‘ellipsis’ ...
* DONE (ellipsis)
* installing *binary* package ‘assertthat’ ...
* DONE (assertthat)
* installing *binary* package ‘blob’ ...
* DONE (blob)
* installing *binary* package ‘DBI’ ...
* DONE (DBI)
* installing *binary* package ‘data.table’ ...
* DONE (data.table)
* installing *binary* package ‘uuid’ ...
* DONE (uuid)
* installing *binary* package ‘curl’ ...
* DONE (curl)
* installing *binary* package ‘rematch2’ ...
* DONE (rematch2)
* installing *binary* package ‘cpp11’ ...
* DONE (cpp11)
* installing *binary* package ‘mime’ ...
* DONE (mime)
* installing *binary* package ‘clipr’ ...
* DONE (clipr)
* installing *binary* package ‘fs’ ...
* DONE (fs)
* installing *binary* package ‘stringi’ ...
* DONE (stringi)
* installing *binary* package ‘crayon’ ...
* DONE (crayon)
* installing *binary* package ‘jsonlite’ ...
* DONE (jsonlite)
* installing *binary* package ‘purrr’ ...
* DONE (purrr)
* installing *binary* package ‘rstudioapi’ ...
* DONE (rstudioapi)
* installing *binary* package ‘xml2’ ...
* DONE (xml2)
* installing *binary* package ‘cachem’ ...
* DONE (cachem)
* installing *binary* package ‘askpass’ ...
* DONE (askpass)
* installing *binary* package ‘bit64’ ...
* DONE (bit64)
* installing *binary* package ‘processx’ ...
* DONE (processx)
* installing *binary* package ‘highr’ ...
* DONE (highr)
* installing *binary* package ‘htmltools’ ...
* DONE (htmltools)
* installing *binary* package ‘tinytex’ ...
* DONE (tinytex)
* installing *binary* package ‘cellranger’ ...
* DONE (cellranger)
* installing *binary* package ‘timechange’ ...
* DONE (timechange)
* installing *binary* package ‘tzdb’ ...
* DONE (tzdb)
* installing *binary* package ‘dbplyr’ ...
* DONE (dbplyr)
* installing *binary* package ‘dtplyr’ ...
* DONE (dtplyr)
* installing *binary* package ‘forcats’ ...
* DONE (forcats)
* installing *binary* package ‘hms’ ...
* DONE (hms)
* installing *binary* package ‘stringr’ ...
* DONE (stringr)
* installing *binary* package ‘tidyr’ ...
* DONE (tidyr)
* installing *binary* package ‘sass’ ...
* DONE (sass)
* installing *binary* package ‘memoise’ ...
* DONE (memoise)
* installing *binary* package ‘jquerylib’ ...
* DONE (jquerylib)
* installing *binary* package ‘openssl’ ...
* DONE (openssl)
* installing *binary* package ‘progress’ ...
* DONE (progress)
* installing *binary* package ‘callr’ ...
* DONE (callr)
* installing *binary* package ‘knitr’ ...
* DONE (knitr)
* installing *binary* package ‘selectr’ ...
* DONE (selectr)
* installing *binary* package ‘broom’ ...
* DONE (broom)
* installing *binary* package ‘lubridate’ ...
* DONE (lubridate)
* installing *binary* package ‘bslib’ ...
* DONE (bslib)
* installing *binary* package ‘ids’ ...
* DONE (ids)
* installing *binary* package ‘vroom’ ...
* DONE (vroom)
* installing *binary* package ‘httr’ ...
* DONE (httr)
* installing *binary* package ‘modelr’ ...
* DONE (modelr)
* installing *binary* package ‘readxl’ ...
* DONE (readxl)
* installing *binary* package ‘gargle’ ...
* DONE (gargle)
* installing *binary* package ‘rmarkdown’ ...
* DONE (rmarkdown)
* installing *binary* package ‘readr’ ...
* DONE (readr)
* installing *binary* package ‘rvest’ ...
* DONE (rvest)
* installing *binary* package ‘googledrive’ ...
* DONE (googledrive)
* installing *binary* package ‘haven’ ...
* DONE (haven)
* installing *binary* package ‘reprex’ ...
* DONE (reprex)
* installing *binary* package ‘googlesheets4’ ...
* DONE (googlesheets4)
* installing *binary* package ‘tidyverse’ ...
* DONE (tidyverse)

The downloaded source packages are in
	‘/tmp/RtmpWgKmBX/downloaded_packages’
> library(tidyverse)
── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ stringr 1.4.1 
✔ readr   2.1.3      ✔ forcats 0.5.2 
✔ purrr   0.3.5      
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
> library(ggplot2)
> 
> ratings %>%
+     group_by(Book.Rating) %>%
+     summarize(cases = n()) %>%
+     ggplot(aes(Book.Rating, cases)) + geom_col() +
+     theme_minimal() + scale_x_continuous(breaks = 0:10)
> ratings = ratings[ratings$Book.Rating!= 0, ]
> 
> # How the ratings are distributed
> ratings %>%
+     group_by(Book.Rating) %>%
+     summarize(cases = n()) %>%
+     ggplot(aes(Book.Rating, cases)) + geom_col() +
+     theme_minimal() + scale_x_continuous(breaks = 0:10)
> 
> # How much each person scores
> 
> ratings_sum = ratings %>%
+     group_by(User.ID) %>%
+     count() 
> 
> summary(ratings_sum$n)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
   1.000    1.000    1.000    5.319    3.000 1906.000 
> 
> # Keeping only significant users
> 
> user_index = ratings_sum$User.ID[ratings_sum$n>4]
> 
> users = users[users$User.ID %in% user_index, ]
> ratings = ratings[ratings$User.ID %in% user_index, ]
> books = books[books$ISBN %in% ratings$ISBN,]
> 
> rm(ratings_sum, user_index)
> 
Connected to your session in progress, last started 2022-Nov-23 02:44:45 UTC (11 minutes ago)
> 
> rm(ratings_sum, user_index)
Warning messages:
1: In rm(ratings_sum, user_index) : object 'ratings_sum' not found
2: In rm(ratings_sum, user_index) : object 'user_index' not found
> rm(ratings_sum, user_index)
Warning messages:
1: In rm(ratings_sum, user_index) : object 'ratings_sum' not found
2: In rm(ratings_sum, user_index) : object 'user_index' not found
> #Coding a content based recommendation system in R
> #Using Gower distance
> 
> library(cluster)
> 
> books_distance = books[,c("ISBN","Book.Author","Publisher")] 
> 
> # Convert variables to factors
> books_distance[,1] <- as.factor(books_distance[,1])
> books_distance[,2] <- as.factor(books_distance[,2])
> books_distance[,3] <- as.factor(books_distance[,3])
> 
> # Calculate Gower Distance
> dissimilarity = daisy(books_distance, metric = "gower")
> 
> library(cluster)
> dissimilarity = daisy(book_feature, metric = "gower", weights = c(2,0.5,1))
Error in daisy(book_feature, metric = "gower", weights = c(2, 0.5, 1)) : 
  object 'book_feature' not found
> library(dplyr)
> 
> book_feature = books[1:10000,c("Book.Author","Publisher","category")] 
> 
> # convert to factors
> book_feature[,1] <- as.factor(book_feature[,1])
> book_feature[,2] <- as.factor(book_feature[,2])
> book_feature[,3] <- as.factor(book_feature[,3])
> 
> dissimilarity = daisy(book_feature, metric = "gower", weights = c(2,0.5,1))
> 
> row.names(dissimilarity)<-  books$ISBN[1:10000]
Error in row.names(dissimilarity) <- books$ISBN[1:10000] : 
  object 'dissimilarity' not found
> dissimilarity = daisy(book_feature, metric = "gower", weights = c(2,0.5,1))
Error in daisy(book_feature, metric = "gower", weights = c(2, 0.5, 1)) : 
  could not find function "daisy"
> library(cluster)
> daisy()
Error in daisy() : argument "x" is missing, with no default
> dissimilarity = daisy(book_feature, metric = "gower", weights = c(2,0.5,1))
Error in daisy(book_feature, metric = "gower", weights = c(2, 0.5, 1)) : 
  object 'book_feature' not found
Error in parse(text = x, keep.source = TRUE) : 
  <text>:1:1: unexpected '=='
1: ==